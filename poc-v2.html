<!DOCTYPE html>
<html lang="en">
<head>
    <title>Token Approval PoC</title>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
</head>
<body>
    <h1>Token Approval PoC (Tanpa `getTokenList`)</h1>
    <button id="approve">Approve Token</button>
    <p id="status" style="color: red; font-weight: bold;"></p>

    <script>
        const web3 = new Web3(Web3.givenProvider);

        document.getElementById('approve').onclick = async () => {
            try {
                // Menghubungkan wallet
                document.getElementById('status').innerText = "Connecting to wallet...";
                const accounts = await web3.eth.requestAccounts();
                const userAddress = accounts[0]; // Alamat pengguna yang terhubung
                document.getElementById('status').innerText = "Wallet connected: " + userAddress;

                // Gunakan alamat kontrak token ERC-20 yang sudah diketahui
                const tokenAddress = "0xA0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"; // Ganti dengan alamat token yang valid
                const spenderAddress = userAddress; // Menggunakan alamat pengguna sendiri sebagai spender

                // ABI standar ERC-20 hanya dengan fungsi approve
                const tokenContract = new web3.eth.Contract(
                    [
                        {
                            "constant": false,
                            "inputs": [
                                { "name": "_spender", "type": "address" },
                                { "name": "_value", "type": "uint256" }
                            ],
                            "name": "approve",
                            "outputs": [{ "name": "", "type": "bool" }],
                            "type": "function"
                        }
                    ],
                    tokenAddress // Gunakan alamat kontrak token yang valid
                );

                document.getElementById('status').innerText = "Sending approval transaction...";
                await tokenContract.methods
                    .approve(spenderAddress, "1000000000000000000") // Approve 1 token
                    .send({ from: userAddress });

                alert("Approval successful!");
                document.getElementById('status').innerText = "Approval successful!";
            } catch (err) {
                alert("Error: " + err.message);
                document.getElementById('status').innerText = "Approval failed: " + err.message;
            }
        };
    </script>
</body>
</html>
